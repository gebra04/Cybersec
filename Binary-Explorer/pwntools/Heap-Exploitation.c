#include <stdio.h>
#include <stdlib.h>
#include <string.h>

char *global_ptr;

void win() {
    printf("You have exploited the program!\n");
    system("/bin/sh");
}

void vuln() {
    char *ptr = malloc(64);
    strcpy(ptr, "Some data");
    global_ptr = ptr;
    free(ptr); // Vulnerabilidade: UAF
}

int main() {
    vuln();
    // Uso após liberação de ptr
    strcpy(global_ptr, "\x90\x90\x90\x90\x90\x90\x90\x90" "\xef\xbe\xad\xde");
    return 0;
}
